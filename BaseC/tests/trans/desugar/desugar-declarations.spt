module desugar-declarations

language Metac

test desugar var declaration [[
  static unsigned int x, y = 2;
]] run desugar-all to Declarations([
    VarDeclaration(
      [Static()],
      Type([], UInt32()),
      Declarator(None(), _),
      Decl(Identifier("x"{_})),
      None()
    ),
    VarDeclaration(
      [Static()],
      Type([], UInt32()),
      Declarator(_, _),
      Decl(Identifier("y"{_})),
      Some(Integer("2"){_})
    )
  ])

test desugar typedefs [[
  typedef unsigned const int a, *b(int);
]] run strip-annos to Declarations([
    TypedefDeclaration(
      Type([Const], UInt32),
      Declarator(_, _),
      Decl(Identifier("a"))
    ),
    TypedefDeclaration(
      Type([Const], UInt32),
      Declarator(_, _),
      Decl(Identifier("b"))
    )
  ])

test enum declaration [[
  enum X {A};
  struct Y {};
]] run desugar-all to Declarations([
    _,
    _
  ])
