module test-utils

imports

  BaseC/trans/analysis/-
  include/Metac

rules

  get-decl-from-program:
    Declarations([decl]) -> decl

  get-expr-from-program =
    find-elem(?Return(Some(x))) ; !x

  get-fundef-from-program:
    Declarations([fundef]) -> fundef

  get-stmt-from-program:
    Declarations([FunDef(_, _, _, CompoundStatement([stmt]))]) -> stmt

strategies

  find-elem(s) =
    oncetd(s ; ?x) ; !x
